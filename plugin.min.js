tinymce.PluginManager.add("statistics",function(e){function t(){var t,n,r,i,s,o,u;r=e.getParam("statistics_countregex",/[\w\u2019\x27\-]+/g);i=e.getParam("statistics_cleanregex",/[0-9.(),;:!?%#$?\x27\x22_+=\\\/\-]*/g);s=e.getParam("statistics_imageregex",/<img /g);o=e.getParam("statistics_tableregex",/<table/g);listre=e.getParam("statistics_listregex",/<ul|<ol/g);u=e.getParam("statistics_linkregex",/<a /g);var a=e.getContent({format:"raw"});var f=0;var l=0;var c=0;var h=0;var p=0;var d=0;if(a){var v=a.match(s);if(v){c=v.length}var m=a.match(o);if(m){h=m.length}var g=a.match(listre);if(g){p=g.length}var y=a.match(u);if(y){d=y.length}a=a.replace(/\.\.\./g," ");a=a.replace(/<.[^<>]*?>/g," ").replace(/Â |&#160;/gi," ");a=tinymce.trim(a);f=a.length;a=a.replace(/(\w+)(&.+?;)+(\w+)/,"$1$3").replace(/&.+?;/g," ");a=a.replace(i,"");var b=a.match(r);if(b){l=b.length}}t='<table role="presentation" cellspacing="0" style="width:200px" class="mce-statistics"><tbody>';t+="<tr><td>"+tinymce.translate("Number of characters")+":</td><td> "+f+"</td></tr>";t+="<tr><td>"+tinymce.translate("Number of words")+":</td><td> "+l+"</td></tr>";var w=0;if(l>0)w=Math.round(f/l*100)/100;t+="<tr><td>"+tinymce.translate("Average word length")+":</td><td> "+w+"</td></tr>";if(tinymce.PluginManager.get("image")!=null)t+="<tr><td>"+tinymce.translate("Number of images")+":</td><td> "+c+"</td></tr>";if(tinymce.PluginManager.get("table")!=null)t+="<tr><td>"+tinymce.translate("Number of tables")+":</td><td> "+h+"</td></tr>";if(tinymce.PluginManager.get("lists")!=null)t+="<tr><td>"+tinymce.translate("Number of lists")+":</td><td> "+p+"</td></tr>";if(tinymce.PluginManager.get("link")!=null)t+="<tr><td>"+tinymce.translate("Number of hyperlinks")+":</td><td> "+d+"</td></tr>";t+="</tbody></table>";var E={type:"container",html:t};n=e.windowManager.open({title:"Statistics",spacing:10,padding:10,items:[E],buttons:[{text:"Close",onclick:function(){n.close()}}]})}e.addMenuItem("statistics",{text:"Statistics",onclick:t,context:"view"})})
